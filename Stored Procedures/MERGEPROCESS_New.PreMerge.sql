SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO

CREATE PROC [MERGEPROCESS_New].[PreMerge]
    AS
Declare @LogDate datetime = (Select getdate())
 
INSERT INTO MERGEPROCESS_New.LogPreMergeAccount
Select a.FK_MergeID,ObjectType, 'Winner' MergeRecordType, @LogDate LogDate,
        -- updateme add all columns from prodcopy.
		accountcategorycode,	accountcategorycodename,	accountclassificationcode,	accountclassificationcodename,	accountid,	accountnumber,	accountratingcode,	accountratingcodename,	address1_addressid,	address1_addresstypecode,	address1_addresstypecodename,	address1_city,	address1_composite,	address1_country,	address1_county,	address1_fax,	address1_freighttermscode,	address1_freighttermscodename,	address1_latitude,	address1_line1,	address1_line2,	address1_line3,	address1_longitude,	address1_name,	address1_postalcode,	address1_postofficebox,	address1_primarycontactname,	address1_shippingmethodcode,	address1_shippingmethodcodename,	address1_stateorprovince,	address1_telephone1,	address1_telephone2,	address1_telephone3,	address1_upszone,	address1_utcoffset,	address2_addressid,	address2_addresstypecode,	address2_addresstypecodename,	address2_city,	address2_composite,	address2_country,	address2_county,	address2_fax,	address2_freighttermscode,	address2_freighttermscodename,	address2_latitude,	address2_line1,	address2_line2,	address2_line3,	address2_longitude,	address2_name,	address2_postalcode,	address2_postofficebox,	address2_primarycontactname,	address2_shippingmethodcode,	address2_shippingmethodcodename,	address2_stateorprovince,	address2_telephone1,	address2_telephone2,	address2_telephone3,	address2_upszone,	address2_utcoffset,	aging30,	aging30_base,	aging60,	aging60_base,	aging90,	aging90_base,	businesstypecode,	businesstypecodename,	createdby,	createdbyexternalparty,	createdbyexternalpartyname,	createdbyexternalpartyyominame,	createdbyname,	createdbyyominame,	createdon,	createdonbehalfby,	createdonbehalfbyname,	createdonbehalfbyyominame,	creditlimit,	creditlimit_base,	creditonhold,	creditonholdname,	customersizecode,	customersizecodename,	customertypecode,	customertypecodename,	defaultpricelevelid,	defaultpricelevelidname,	description,	donotbulkemail,	donotbulkemailname,	donotbulkpostalmail,	donotbulkpostalmailname,	donotemail,	donotemailname,	donotfax,	donotfaxname,	donotphone,	donotphonename,	donotpostalmail,	donotpostalmailname,	donotsendmarketingmaterialname,	donotsendmm,	emailaddress1,	emailaddress2,	emailaddress3,	entityimage,	entityimage_timestamp,	entityimage_url,	entityimageid,	exchangerate,	fax,	followemail,	followemailname,	ftpsiteurl,	importsequencenumber,	industrycode,	industrycodename,	isprivatename,	lastonholdtime,	lastusedincampaign,	marketcap,	marketcap_base,	marketingonly,	marketingonlyname,	masteraccountidname,	masteraccountidyominame,	masterid,	merged,	mergedname,	modifiedby,	modifiedbyexternalparty,	modifiedbyexternalpartyname,	modifiedbyexternalpartyyominame,	modifiedbyname,	modifiedbyyominame,	modifiedon,	modifiedonbehalfby,	modifiedonbehalfbyname,	modifiedonbehalfbyyominame,	name,	numberofemployees,	onholdtime,	opendeals,	opendeals_date,	opendeals_state,	openrevenue,	openrevenue_base,	openrevenue_date,	openrevenue_state,	originatingleadid,	originatingleadidname,	originatingleadidyominame,	overriddencreatedon,	ownerid,	owneridname,	owneridtype,	owneridyominame,	ownershipcode,	ownershipcodename,	owningbusinessunit,	owningteam,	owninguser,	parentaccountid,	parentaccountidname,	parentaccountidyominame,	participatesinworkflow,	participatesinworkflowname,	paymenttermscode,	paymenttermscodename,	preferredappointmentdaycode,	preferredappointmentdaycodename,	preferredappointmenttimecode,	preferredappointmenttimecodename,	preferredcontactmethodcode,	preferredcontactmethodcodename,	preferredequipmentid,	preferredequipmentidname,	preferredserviceid,	preferredserviceidname,	preferredsystemuserid,	preferredsystemuseridname,	preferredsystemuseridyominame,	primarycontactid,	primarycontactidname,	primarycontactidyominame,	primarysatoriid,	primarytwitterid,	processid,	revenue,	revenue_base,	sharesoutstanding,	shippingmethodcode,	shippingmethodcodename,	sic,	slaid,	slainvokedid,	slainvokedidname,	slaname,	stageid,	statecode,	statecodename,	statuscode,	statuscodename,	stockexchange,	str_category,	str_custom1,	str_custom2,	str_custom3,	str_custom4,	str_dwduplicate,	str_dwduplicatename,	str_dwid,	str_dwmodifiedon,	str_id,	str_idtext,	str_lastactivitydate,	str_leadsourcecode,	str_leadsourcecodename,	str_league1,	str_league2,	str_league3,	str_league4,	str_league5,	str_league6,	str_league7,	str_league8,	str_marketingaccountindustryid,	str_marketingaccountindustryidname,	str_marketingaccountsourceid,	str_marketingaccountsourceidname,	str_nextactivitydate,	str_number,	str_partnersalesperson,	str_partnersalespersonname,	str_partnersalespersonyominame,	str_partnerserviceperson,	str_partnerservicepersonname,	str_partnerservicepersonyominame,	str_partnershipclosedate,	str_partnershipcloseprobability,	str_partnershipcomments,	str_partnershipphase,	str_partnershiprevenue,	str_partnershiprevenue_base,	str_partnershipstatus,	str_premiumsalesperson,	str_premiumsalespersonname,	str_premiumsalespersonyominame,	str_premiumserviceperson,	str_premiumservicepersonname,	str_premiumservicepersonyominame,	str_search,	str_select,	str_selectname,	str_serviceperson,	str_servicepersonname,	str_servicepersonyominame,	str_source,	telephone1,	telephone2,	telephone3,	territorycode,	territorycodename,	territoryid,	territoryidname,	tickersymbol,	timespentbymeonemailandmeetings,	timezoneruleversionnumber,	transactioncurrencyid,	transactioncurrencyidname,	traversedpath,	utcconversiontimezonecode,	versionnumber,	websiteurl,	yominame,	copyloaddate,	new_ssbcrmsystemssidwinner,	new_ssbcrmsystemdimcustomerids,	new_ssbcrmsystemssidwinnersourcesystem,	new_ssbcrmsystemacctid
FROM MERGEPROCESS_New.Queue a
JOIN mergeprocess_new.tmp_pcaccount b
    ON a.Winning_ID = b.Accountid
UNION ALL
Select a.FK_MergeID,ObjectType, 'Loser' MergeRecordType, @LogDate LogDate,
        -- updateme add all columns from prodcopy.
	accountcategorycode,	accountcategorycodename,	accountclassificationcode,	accountclassificationcodename,	accountid,	accountnumber,	accountratingcode,	accountratingcodename,	address1_addressid,	address1_addresstypecode,	address1_addresstypecodename,	address1_city,	address1_composite,	address1_country,	address1_county,	address1_fax,	address1_freighttermscode,	address1_freighttermscodename,	address1_latitude,	address1_line1,	address1_line2,	address1_line3,	address1_longitude,	address1_name,	address1_postalcode,	address1_postofficebox,	address1_primarycontactname,	address1_shippingmethodcode,	address1_shippingmethodcodename,	address1_stateorprovince,	address1_telephone1,	address1_telephone2,	address1_telephone3,	address1_upszone,	address1_utcoffset,	address2_addressid,	address2_addresstypecode,	address2_addresstypecodename,	address2_city,	address2_composite,	address2_country,	address2_county,	address2_fax,	address2_freighttermscode,	address2_freighttermscodename,	address2_latitude,	address2_line1,	address2_line2,	address2_line3,	address2_longitude,	address2_name,	address2_postalcode,	address2_postofficebox,	address2_primarycontactname,	address2_shippingmethodcode,	address2_shippingmethodcodename,	address2_stateorprovince,	address2_telephone1,	address2_telephone2,	address2_telephone3,	address2_upszone,	address2_utcoffset,	aging30,	aging30_base,	aging60,	aging60_base,	aging90,	aging90_base,	businesstypecode,	businesstypecodename,	createdby,	createdbyexternalparty,	createdbyexternalpartyname,	createdbyexternalpartyyominame,	createdbyname,	createdbyyominame,	createdon,	createdonbehalfby,	createdonbehalfbyname,	createdonbehalfbyyominame,	creditlimit,	creditlimit_base,	creditonhold,	creditonholdname,	customersizecode,	customersizecodename,	customertypecode,	customertypecodename,	defaultpricelevelid,	defaultpricelevelidname,	description,	donotbulkemail,	donotbulkemailname,	donotbulkpostalmail,	donotbulkpostalmailname,	donotemail,	donotemailname,	donotfax,	donotfaxname,	donotphone,	donotphonename,	donotpostalmail,	donotpostalmailname,	donotsendmarketingmaterialname,	donotsendmm,	emailaddress1,	emailaddress2,	emailaddress3,	entityimage,	entityimage_timestamp,	entityimage_url,	entityimageid,	exchangerate,	fax,	followemail,	followemailname,	ftpsiteurl,	importsequencenumber,	industrycode,	industrycodename,	isprivatename,	lastonholdtime,	lastusedincampaign,	marketcap,	marketcap_base,	marketingonly,	marketingonlyname,	masteraccountidname,	masteraccountidyominame,	masterid,	merged,	mergedname,	modifiedby,	modifiedbyexternalparty,	modifiedbyexternalpartyname,	modifiedbyexternalpartyyominame,	modifiedbyname,	modifiedbyyominame,	modifiedon,	modifiedonbehalfby,	modifiedonbehalfbyname,	modifiedonbehalfbyyominame,	name,	numberofemployees,	onholdtime,	opendeals,	opendeals_date,	opendeals_state,	openrevenue,	openrevenue_base,	openrevenue_date,	openrevenue_state,	originatingleadid,	originatingleadidname,	originatingleadidyominame,	overriddencreatedon,	ownerid,	owneridname,	owneridtype,	owneridyominame,	ownershipcode,	ownershipcodename,	owningbusinessunit,	owningteam,	owninguser,	parentaccountid,	parentaccountidname,	parentaccountidyominame,	participatesinworkflow,	participatesinworkflowname,	paymenttermscode,	paymenttermscodename,	preferredappointmentdaycode,	preferredappointmentdaycodename,	preferredappointmenttimecode,	preferredappointmenttimecodename,	preferredcontactmethodcode,	preferredcontactmethodcodename,	preferredequipmentid,	preferredequipmentidname,	preferredserviceid,	preferredserviceidname,	preferredsystemuserid,	preferredsystemuseridname,	preferredsystemuseridyominame,	primarycontactid,	primarycontactidname,	primarycontactidyominame,	primarysatoriid,	primarytwitterid,	processid,	revenue,	revenue_base,	sharesoutstanding,	shippingmethodcode,	shippingmethodcodename,	sic,	slaid,	slainvokedid,	slainvokedidname,	slaname,	stageid,	statecode,	statecodename,	statuscode,	statuscodename,	stockexchange,	str_category,	str_custom1,	str_custom2,	str_custom3,	str_custom4,	str_dwduplicate,	str_dwduplicatename,	str_dwid,	str_dwmodifiedon,	str_id,	str_idtext,	str_lastactivitydate,	str_leadsourcecode,	str_leadsourcecodename,	str_league1,	str_league2,	str_league3,	str_league4,	str_league5,	str_league6,	str_league7,	str_league8,	str_marketingaccountindustryid,	str_marketingaccountindustryidname,	str_marketingaccountsourceid,	str_marketingaccountsourceidname,	str_nextactivitydate,	str_number,	str_partnersalesperson,	str_partnersalespersonname,	str_partnersalespersonyominame,	str_partnerserviceperson,	str_partnerservicepersonname,	str_partnerservicepersonyominame,	str_partnershipclosedate,	str_partnershipcloseprobability,	str_partnershipcomments,	str_partnershipphase,	str_partnershiprevenue,	str_partnershiprevenue_base,	str_partnershipstatus,	str_premiumsalesperson,	str_premiumsalespersonname,	str_premiumsalespersonyominame,	str_premiumserviceperson,	str_premiumservicepersonname,	str_premiumservicepersonyominame,	str_search,	str_select,	str_selectname,	str_serviceperson,	str_servicepersonname,	str_servicepersonyominame,	str_source,	telephone1,	telephone2,	telephone3,	territorycode,	territorycodename,	territoryid,	territoryidname,	tickersymbol,	timespentbymeonemailandmeetings,	timezoneruleversionnumber,	transactioncurrencyid,	transactioncurrencyidname,	traversedpath,	utcconversiontimezonecode,	versionnumber,	websiteurl,	yominame,	copyloaddate,	new_ssbcrmsystemssidwinner,	new_ssbcrmsystemdimcustomerids,	new_ssbcrmsystemssidwinnersourcesystem,	new_ssbcrmsystemacctid
FROM MERGEPROCESS_New.Queue a
JOIN mergeprocess_new.tmp_pcaccount b
    ON a.Losing_ID = b.Accountid
 
INSERT INTO MERGEPROCESS_New.LogPreMergeContact
SELECT a.FK_MergeID,ObjectType, 'Winner' MergeRecordType, @LogDate LogDate,
        -- updateme add all columns from prodcopy.
		accountid,	accountidname,	accountidyominame,	accountrolecode,	accountrolecodename,	address1_addressid,	address1_addresstypecode,	address1_addresstypecodename,	address1_city,	address1_composite,	address1_country,	address1_county,	address1_fax,	address1_freighttermscode,	address1_freighttermscodename,	address1_latitude,	address1_line1,	address1_line2,	address1_line3,	address1_longitude,	address1_name,	address1_postalcode,	address1_postofficebox,	address1_primarycontactname,	address1_shippingmethodcode,	address1_shippingmethodcodename,	address1_stateorprovince,	address1_telephone1,	address1_telephone2,	address1_telephone3,	address1_upszone,	address1_utcoffset,	address2_addressid,	address2_addresstypecode,	address2_addresstypecodename,	address2_city,	address2_composite,	address2_country,	address2_county,	address2_fax,	address2_freighttermscode,	address2_freighttermscodename,	address2_latitude,	address2_line1,	address2_line2,	address2_line3,	address2_longitude,	address2_name,	address2_postalcode,	address2_postofficebox,	address2_primarycontactname,	address2_shippingmethodcode,	address2_shippingmethodcodename,	address2_stateorprovince,	address2_telephone1,	address2_telephone2,	address2_telephone3,	address2_upszone,	address2_utcoffset,	address3_addressid,	address3_addresstypecode,	address3_addresstypecodename,	address3_city,	address3_composite,	address3_country,	address3_county,	address3_fax,	address3_freighttermscode,	address3_freighttermscodename,	address3_latitude,	address3_line1,	address3_line2,	address3_line3,	address3_longitude,	address3_name,	address3_postalcode,	address3_postofficebox,	address3_primarycontactname,	address3_shippingmethodcode,	address3_shippingmethodcodename,	address3_stateorprovince,	address3_telephone1,	address3_telephone2,	address3_telephone3,	address3_upszone,	address3_utcoffset,	aging30,	aging30_base,	aging60,	aging60_base,	aging90,	aging90_base,	anniversary,	annualincome,	annualincome_base,	assistantname,	assistantphone,	birthdate,	business2,	callback,	childrensnames,	company,	contactid,	createdby,	createdbyexternalparty,	createdbyexternalpartyname,	createdbyexternalpartyyominame,	createdbyname,	createdbyyominame,	createdon,	createdonbehalfby,	createdonbehalfbyname,	createdonbehalfbyyominame,	creditlimit,	creditlimit_base,	creditonhold,	creditonholdname,	customersizecode,	customersizecodename,	customertypecode,	customertypecodename,	defaultpricelevelid,	defaultpricelevelidname,	department,	description,	donotbulkemail,	donotbulkemailname,	donotbulkpostalmail,	donotbulkpostalmailname,	donotemail,	donotemailname,	donotfax,	donotfaxname,	donotphone,	donotphonename,	donotpostalmail,	donotpostalmailname,	donotsendmarketingmaterialname,	donotsendmm,	educationcode,	educationcodename,	emailaddress1,	emailaddress2,	emailaddress3,	employeeid,	entityimage,	entityimage_timestamp,	entityimage_url,	entityimageid,	exchangerate,	externaluseridentifier,	familystatuscode,	familystatuscodename,	fax,	firstname,	followemail,	followemailname,	ftpsiteurl,	fullname,	gendercode,	gendercodename,	governmentid,	haschildrencode,	haschildrencodename,	home2,	importsequencenumber,	isbackofficecustomer,	isbackofficecustomername,	isprivatename,	jobtitle,	lastname,	lastonholdtime,	lastusedincampaign,	leadsourcecode,	leadsourcecodename,	managername,	managerphone,	marketingonly,	marketingonlyname,	mastercontactidname,	mastercontactidyominame,	masterid,	merged,	mergedname,	middlename,	mobilephone,	modifiedby,	modifiedbyexternalparty,	modifiedbyexternalpartyname,	modifiedbyexternalpartyyominame,	modifiedbyname,	modifiedbyyominame,	modifiedon,	modifiedonbehalfby,	modifiedonbehalfbyname,	modifiedonbehalfbyyominame,	nickname,	numberofchildren,	onholdtime,	originatingleadid,	originatingleadidname,	originatingleadidyominame,	overriddencreatedon,	ownerid,	owneridname,	owneridtype,	owneridyominame,	owningbusinessunit,	owningteam,	owninguser,	pager,	parentcontactid,	parentcontactidname,	parentcontactidyominame,	parentcustomerid,	parentcustomeridname,	parentcustomeridtype,	parentcustomeridyominame,	participatesinworkflow,	participatesinworkflowname,	paymenttermscode,	paymenttermscodename,	preferredappointmentdaycode,	preferredappointmentdaycodename,	preferredappointmenttimecode,	preferredappointmenttimecodename,	preferredcontactmethodcode,	preferredcontactmethodcodename,	preferredequipmentid,	preferredequipmentidname,	preferredserviceid,	preferredserviceidname,	preferredsystemuserid,	preferredsystemuseridname,	preferredsystemuseridyominame,	processid,	salutation,	shippingmethodcode,	shippingmethodcodename,	slaid,	slainvokedid,	slainvokedidname,	slaname,	spousesname,	stageid,	statecode,	statecodename,	statuscode,	statuscodename,	str_agerange,	str_allspendtotal,	str_allspendtotal_base,	str_casesource,	str_casestatus,	str_casesubject,	str_casetype,	str_category,	str_college,	str_concertinterests,	str_dwcompanies,	str_dwduplicate,	str_dwduplicatename,	str_dwid,	str_dwmodifiedon,	str_externalcapacitymodel,	str_externalclustername,	str_externalprioritymodel,	str_facebookhandle,	str_favoritedestination,	str_favoriteplayer,	str_favoriterestaurant,	str_favoriteteam,	str_hobbies,	str_hometown,	str_householdincome,	str_householdincome_base,	str_id,	str_idtext,	str_instagramhandle,	str_lastactivitydate,	str_marketingcontactsourceid,	str_marketingcontactsourceidname,	str_marketingcontacttypeid,	str_marketingcontacttypeidname,	str_musicclassical,	str_musicclassicalname,	str_musiccountry,	str_musiccountryname,	str_musicpop,	str_musicpopname,	str_musicrap,	str_musicrapname,	str_musicrock,	str_musicrockname,	str_neglectmeter,	str_neglectreason,	str_nextactivitydate,	str_nextactivitysubject,	str_number,	str_openactivitycount,	str_openticketcase,	str_openticketcasename,	str_openticketopportunity,	str_openticketopportunityname,	str_oppdaysinstage,	str_opportunityrevenue,	str_opportunityrevenue_base,	str_oppproduct,	str_oppsource,	str_oppstage,	str_opptagcount,	str_otherinformation,	str_partnerid,	str_partneridname,	str_partneridyominame,	str_premiumtype,	str_premiumtypename,	str_priority,	str_rating,	str_ratingname,	str_score,	str_search,	str_select,	str_selectname,	str_serviceperson,	str_servicepersonname,	str_servicepersonyominame,	str_showsfamily,	str_showsfamilyname,	str_since,	str_source,	str_sportsinterests,	str_ticketeventtotalall,	str_ticketeventtotalarena,	str_ticketeventtotallast,	str_ticketeventtotalthis,	str_ticketnumberaverageall,	str_ticketnumberaveragearena,	str_ticketnumberaveragelast,	str_ticketnumberaveragethis,	str_ticketnumbertotalall,	str_ticketnumbertotalarena,	str_ticketnumbertotallast,	str_ticketnumbertotalthis,	str_ticketpriceaverageall,	str_ticketpriceaverageall_base,	str_ticketpriceaveragearena,	str_ticketpriceaveragearena_base,	str_ticketpriceaveragelast,	str_ticketpriceaveragelast_base,	str_ticketpriceaveragethis,	str_ticketpriceaveragethis_base,	str_ticketspendaverageall,	str_ticketspendaverageall_base,	str_ticketspendaveragearena,	str_ticketspendaveragearena_base,	str_ticketspendaveragelast,	str_ticketspendaveragelast_base,	str_ticketspendaveragethis,	str_ticketspendaveragethis_base,	str_ticketspendtotalall,	str_ticketspendtotalall_base,	str_ticketspendtotalarena,	str_ticketspendtotalarena_base,	str_ticketspendtotallast,	str_ticketspendtotallast_base,	str_ticketspendtotalthis,	str_ticketspendtotalthis_base,	str_twitterhandle,	suffix,	telephone1,	telephone2,	telephone3,	territorycode,	territorycodename,	timespentbymeonemailandmeetings,	timezoneruleversionnumber,	transactioncurrencyid,	transactioncurrencyidname,	traversedpath,	utcconversiontimezonecode,	versionnumber,	websiteurl,	yomifirstname,	yomifullname,	yomilastname,	yomimiddlename,	copyloaddate,	new_ssbcrmsystemssidwinner,	new_ssbcrmsystemdimcustomerids,	new_ssbcrmsystemSSIDWinnerSourceSystem,	new_ssbcrmsystemcontactid,	new_ssbcrmsystemacctid,	new_legacycontactid,	cdi_age,	cdi_allowtextmessages,	cdi_allowtextmessagesname,	cdi_facebook,	cdi_grade,	cdi_identifiedon,	cdi_image,	cdi_ip,	cdi_latitude,	cdi_linkedin,	cdi_longitude,	cdi_partitionkey,	cdi_rowkey,	cdi_score,	cdi_social,	cdi_totalscore,	cdi_twitter,	cdi_visitorkey,	lions_cc1,	lions_cc2,	lions_cc3,	lions_cc4,	lions_companyname,	lions_dem_businessowner,	lions_dem_distancetostadium,	lions_dem_dominantvehiclelifestyle,	lions_dem_educationlevel,	lions_dem_homelengthofresidence,	lions_dem_homemarketvalue,	lions_dem_homeownerrenter,	lions_dem_homepropertytype,	lions_dem_homeyearbuilt,	lions_dem_knownownedvehicles,	lions_dem_newcarbuyer,	lions_dem_newcarbuyername,	lions_dem_occupation,	lions_dem_occupationdetail,	lions_dem_personicxcluster,	lions_dem_presenceofchildren,	lions_dem_presenceofchildrenname,	lions_dem_veteran,	lions_dem_veteranname,	lions_detroitlionsinfo,	lions_detroitlionsinfoname,	lions_discounts_and_promotions,	lions_discounts_and_promotionsname,	lions_flag_currentcubclubmember,	lions_flag_currentcubclubmembername,	lions_flag_currenteventbuyer,	lions_flag_currenteventbuyername,	lions_flag_currentfanplan,	lions_flag_currentfanplanname,	lions_flag_currentgastm,	lions_flag_currentgastmname,	lions_flag_currentgroup,	lions_flag_currentgroupname,	lions_flag_currentlionsflashrecipient,	lions_flag_currentlionsflashrecipientname,	lions_flag_currentlogeboxstm,	lions_flag_currentlogeboxstmname,	lions_flag_currentonlinemerchbuyer,	lions_flag_currentonlinemerchbuyername,	lions_flag_currentpremiumclubstm,	lions_flag_currentpremiumclubstmname,	lions_flag_currentseasonticketmember,	lions_flag_currentseasonticketmembername,	lions_flag_currentsecondarymarketbuyer,	lions_flag_currentsecondarymarketbuyername,	lions_flag_currentsinglegamebuyer,	lions_flag_currentsinglegamebuyername,	lions_flag_currentsuiteleaseholder,	lions_flag_currentsuiteleaseholdername,	lions_flag_currentsuiterental,	lions_flag_currentsuiterentalname,	lions_flag_currenttunnelclubstm,	lions_flag_currenttunnelclubstmname,	lions_flag_currentyouthfootballparticipant,	lions_flag_currentyouthfootballparticipantname,	lions_flag_formercubclubmember,	lions_flag_formercubclubmembername,	lions_flag_formereventbuyer,	lions_flag_formereventbuyername,	lions_flag_formerfanplan,	lions_flag_formerfanplanname,	lions_flag_formergastm,	lions_flag_formergastmname,	lions_flag_formergroup,	lions_flag_formergroupname,	lions_flag_formerlionsflashrecipient,	lions_flag_formerlionsflashrecipientname,	lions_flag_formerlogeboxstm,	lions_flag_formerlogeboxstmname,	lions_flag_formeronlinemerchbuyer,	lions_flag_formeronlinemerchbuyername,	lions_flag_formerpremiumclubstm,	lions_flag_formerpremiumclubstmname,	lions_flag_formerseasonticketmember,	lions_flag_formerseasonticketmembername,	lions_flag_formersecondarymarketbuyer,	lions_flag_formersecondarymarketbuyername,	lions_flag_formersinglegamebuyer,	lions_flag_formersinglegamebuyername,	lions_flag_formersuiteleaseholder,	lions_flag_formersuiteleaseholdername,	lions_flag_formersuiterental,	lions_flag_formersuiterentalname,	lions_flag_formertunnelclubstm,	lions_flag_formertunnelclubstmname,	lions_flag_formeryouthfootballparticipant,	lions_flag_formeryouthfootballparticipantname,	lions_flag_lionsalumni,	lions_flag_lionsalumniname,	lions_flag_mobileappdownload,	lions_flag_mobileappdownloadname,	lions_flag_wifiuser,	lions_flag_wifiusername,	lions_ford_field_info,	lions_ford_field_infoname,	lions_id1,	lions_id2,	lions_id3,	lions_id4,	lions_noids,	lions_primaryaccountid,	str_clientfavoritedefense,	str_clientfavoriteoffense,	str_clientfavoriteopponent,	str_clientfavoriteopponentname,	str_clientfavoriteplayernfl,	str_clienttshirtsize,	str_clienttshirtsizename,	lions_classicrock,	lions_classicrockname,	lions_dem_hhincome,	lions_hiphoprb,	lions_hiphoprbname,	lions_sportingevents,	lions_sportingeventsname,	lions_alumni_activeseasons,	lions_alumni_betterserve,	lions_alumni_foundation,	lions_alumni_jerseynumber,	lions_alumni_othernflteams,	lions_alumni_position,	lions_collegemajor,	lions_communityinterests,	lions_flag_dlwa,	lions_flag_dlwaname,	lions_interestingfact,	lions_pref_classicalmusic,	lions_pref_classicalmusicname,	lions_pref_classicrock,	lions_pref_classicrockname,	lions_pref_countrymusic,	lions_pref_countrymusicname,	lions_pref_familyshows,	lions_pref_familyshowsname,	lions_pref_hiphoprb,	lions_pref_hiphoprbname,	lions_pref_popmusic,	lions_pref_popmusicname,	lions_pref_rapmusic,	lions_pref_rapmusicname,	lions_pref_rockmusic,	lions_pref_rockmusicname,	lions_pref_sportingevents,	lions_pref_sportingeventsname,	lions_pref_youthfootball,	lions_pref_youthfootballname,	lions_senioritydate,	lions_shirtsize,	lions_shirtsizename
FROM MERGEPROCESS_New.Queue a
JOIN mergeprocess_new.tmp_pccontact b
    ON a.Winning_ID = b.contactid
UNION ALL
SELECT a.FK_MergeID,ObjectType, 'Loser' MergeRecordType, @LogDate LogDate,
        -- updateme add all columns from prodcopy.
accountid,	accountidname,	accountidyominame,	accountrolecode,	accountrolecodename,	address1_addressid,	address1_addresstypecode,	address1_addresstypecodename,	address1_city,	address1_composite,	address1_country,	address1_county,	address1_fax,	address1_freighttermscode,	address1_freighttermscodename,	address1_latitude,	address1_line1,	address1_line2,	address1_line3,	address1_longitude,	address1_name,	address1_postalcode,	address1_postofficebox,	address1_primarycontactname,	address1_shippingmethodcode,	address1_shippingmethodcodename,	address1_stateorprovince,	address1_telephone1,	address1_telephone2,	address1_telephone3,	address1_upszone,	address1_utcoffset,	address2_addressid,	address2_addresstypecode,	address2_addresstypecodename,	address2_city,	address2_composite,	address2_country,	address2_county,	address2_fax,	address2_freighttermscode,	address2_freighttermscodename,	address2_latitude,	address2_line1,	address2_line2,	address2_line3,	address2_longitude,	address2_name,	address2_postalcode,	address2_postofficebox,	address2_primarycontactname,	address2_shippingmethodcode,	address2_shippingmethodcodename,	address2_stateorprovince,	address2_telephone1,	address2_telephone2,	address2_telephone3,	address2_upszone,	address2_utcoffset,	address3_addressid,	address3_addresstypecode,	address3_addresstypecodename,	address3_city,	address3_composite,	address3_country,	address3_county,	address3_fax,	address3_freighttermscode,	address3_freighttermscodename,	address3_latitude,	address3_line1,	address3_line2,	address3_line3,	address3_longitude,	address3_name,	address3_postalcode,	address3_postofficebox,	address3_primarycontactname,	address3_shippingmethodcode,	address3_shippingmethodcodename,	address3_stateorprovince,	address3_telephone1,	address3_telephone2,	address3_telephone3,	address3_upszone,	address3_utcoffset,	aging30,	aging30_base,	aging60,	aging60_base,	aging90,	aging90_base,	anniversary,	annualincome,	annualincome_base,	assistantname,	assistantphone,	birthdate,	business2,	callback,	childrensnames,	company,	contactid,	createdby,	createdbyexternalparty,	createdbyexternalpartyname,	createdbyexternalpartyyominame,	createdbyname,	createdbyyominame,	createdon,	createdonbehalfby,	createdonbehalfbyname,	createdonbehalfbyyominame,	creditlimit,	creditlimit_base,	creditonhold,	creditonholdname,	customersizecode,	customersizecodename,	customertypecode,	customertypecodename,	defaultpricelevelid,	defaultpricelevelidname,	department,	description,	donotbulkemail,	donotbulkemailname,	donotbulkpostalmail,	donotbulkpostalmailname,	donotemail,	donotemailname,	donotfax,	donotfaxname,	donotphone,	donotphonename,	donotpostalmail,	donotpostalmailname,	donotsendmarketingmaterialname,	donotsendmm,	educationcode,	educationcodename,	emailaddress1,	emailaddress2,	emailaddress3,	employeeid,	entityimage,	entityimage_timestamp,	entityimage_url,	entityimageid,	exchangerate,	externaluseridentifier,	familystatuscode,	familystatuscodename,	fax,	firstname,	followemail,	followemailname,	ftpsiteurl,	fullname,	gendercode,	gendercodename,	governmentid,	haschildrencode,	haschildrencodename,	home2,	importsequencenumber,	isbackofficecustomer,	isbackofficecustomername,	isprivatename,	jobtitle,	lastname,	lastonholdtime,	lastusedincampaign,	leadsourcecode,	leadsourcecodename,	managername,	managerphone,	marketingonly,	marketingonlyname,	mastercontactidname,	mastercontactidyominame,	masterid,	merged,	mergedname,	middlename,	mobilephone,	modifiedby,	modifiedbyexternalparty,	modifiedbyexternalpartyname,	modifiedbyexternalpartyyominame,	modifiedbyname,	modifiedbyyominame,	modifiedon,	modifiedonbehalfby,	modifiedonbehalfbyname,	modifiedonbehalfbyyominame,	nickname,	numberofchildren,	onholdtime,	originatingleadid,	originatingleadidname,	originatingleadidyominame,	overriddencreatedon,	ownerid,	owneridname,	owneridtype,	owneridyominame,	owningbusinessunit,	owningteam,	owninguser,	pager,	parentcontactid,	parentcontactidname,	parentcontactidyominame,	parentcustomerid,	parentcustomeridname,	parentcustomeridtype,	parentcustomeridyominame,	participatesinworkflow,	participatesinworkflowname,	paymenttermscode,	paymenttermscodename,	preferredappointmentdaycode,	preferredappointmentdaycodename,	preferredappointmenttimecode,	preferredappointmenttimecodename,	preferredcontactmethodcode,	preferredcontactmethodcodename,	preferredequipmentid,	preferredequipmentidname,	preferredserviceid,	preferredserviceidname,	preferredsystemuserid,	preferredsystemuseridname,	preferredsystemuseridyominame,	processid,	salutation,	shippingmethodcode,	shippingmethodcodename,	slaid,	slainvokedid,	slainvokedidname,	slaname,	spousesname,	stageid,	statecode,	statecodename,	statuscode,	statuscodename,	str_agerange,	str_allspendtotal,	str_allspendtotal_base,	str_casesource,	str_casestatus,	str_casesubject,	str_casetype,	str_category,	str_college,	str_concertinterests,	str_dwcompanies,	str_dwduplicate,	str_dwduplicatename,	str_dwid,	str_dwmodifiedon,	str_externalcapacitymodel,	str_externalclustername,	str_externalprioritymodel,	str_facebookhandle,	str_favoritedestination,	str_favoriteplayer,	str_favoriterestaurant,	str_favoriteteam,	str_hobbies,	str_hometown,	str_householdincome,	str_householdincome_base,	str_id,	str_idtext,	str_instagramhandle,	str_lastactivitydate,	str_marketingcontactsourceid,	str_marketingcontactsourceidname,	str_marketingcontacttypeid,	str_marketingcontacttypeidname,	str_musicclassical,	str_musicclassicalname,	str_musiccountry,	str_musiccountryname,	str_musicpop,	str_musicpopname,	str_musicrap,	str_musicrapname,	str_musicrock,	str_musicrockname,	str_neglectmeter,	str_neglectreason,	str_nextactivitydate,	str_nextactivitysubject,	str_number,	str_openactivitycount,	str_openticketcase,	str_openticketcasename,	str_openticketopportunity,	str_openticketopportunityname,	str_oppdaysinstage,	str_opportunityrevenue,	str_opportunityrevenue_base,	str_oppproduct,	str_oppsource,	str_oppstage,	str_opptagcount,	str_otherinformation,	str_partnerid,	str_partneridname,	str_partneridyominame,	str_premiumtype,	str_premiumtypename,	str_priority,	str_rating,	str_ratingname,	str_score,	str_search,	str_select,	str_selectname,	str_serviceperson,	str_servicepersonname,	str_servicepersonyominame,	str_showsfamily,	str_showsfamilyname,	str_since,	str_source,	str_sportsinterests,	str_ticketeventtotalall,	str_ticketeventtotalarena,	str_ticketeventtotallast,	str_ticketeventtotalthis,	str_ticketnumberaverageall,	str_ticketnumberaveragearena,	str_ticketnumberaveragelast,	str_ticketnumberaveragethis,	str_ticketnumbertotalall,	str_ticketnumbertotalarena,	str_ticketnumbertotallast,	str_ticketnumbertotalthis,	str_ticketpriceaverageall,	str_ticketpriceaverageall_base,	str_ticketpriceaveragearena,	str_ticketpriceaveragearena_base,	str_ticketpriceaveragelast,	str_ticketpriceaveragelast_base,	str_ticketpriceaveragethis,	str_ticketpriceaveragethis_base,	str_ticketspendaverageall,	str_ticketspendaverageall_base,	str_ticketspendaveragearena,	str_ticketspendaveragearena_base,	str_ticketspendaveragelast,	str_ticketspendaveragelast_base,	str_ticketspendaveragethis,	str_ticketspendaveragethis_base,	str_ticketspendtotalall,	str_ticketspendtotalall_base,	str_ticketspendtotalarena,	str_ticketspendtotalarena_base,	str_ticketspendtotallast,	str_ticketspendtotallast_base,	str_ticketspendtotalthis,	str_ticketspendtotalthis_base,	str_twitterhandle,	suffix,	telephone1,	telephone2,	telephone3,	territorycode,	territorycodename,	timespentbymeonemailandmeetings,	timezoneruleversionnumber,	transactioncurrencyid,	transactioncurrencyidname,	traversedpath,	utcconversiontimezonecode,	versionnumber,	websiteurl,	yomifirstname,	yomifullname,	yomilastname,	yomimiddlename,	copyloaddate,	new_ssbcrmsystemssidwinner,	new_ssbcrmsystemdimcustomerids,	new_ssbcrmsystemSSIDWinnerSourceSystem,	new_ssbcrmsystemcontactid,	new_ssbcrmsystemacctid,	new_legacycontactid,	cdi_age,	cdi_allowtextmessages,	cdi_allowtextmessagesname,	cdi_facebook,	cdi_grade,	cdi_identifiedon,	cdi_image,	cdi_ip,	cdi_latitude,	cdi_linkedin,	cdi_longitude,	cdi_partitionkey,	cdi_rowkey,	cdi_score,	cdi_social,	cdi_totalscore,	cdi_twitter,	cdi_visitorkey,	lions_cc1,	lions_cc2,	lions_cc3,	lions_cc4,	lions_companyname,	lions_dem_businessowner,	lions_dem_distancetostadium,	lions_dem_dominantvehiclelifestyle,	lions_dem_educationlevel,	lions_dem_homelengthofresidence,	lions_dem_homemarketvalue,	lions_dem_homeownerrenter,	lions_dem_homepropertytype,	lions_dem_homeyearbuilt,	lions_dem_knownownedvehicles,	lions_dem_newcarbuyer,	lions_dem_newcarbuyername,	lions_dem_occupation,	lions_dem_occupationdetail,	lions_dem_personicxcluster,	lions_dem_presenceofchildren,	lions_dem_presenceofchildrenname,	lions_dem_veteran,	lions_dem_veteranname,	lions_detroitlionsinfo,	lions_detroitlionsinfoname,	lions_discounts_and_promotions,	lions_discounts_and_promotionsname,	lions_flag_currentcubclubmember,	lions_flag_currentcubclubmembername,	lions_flag_currenteventbuyer,	lions_flag_currenteventbuyername,	lions_flag_currentfanplan,	lions_flag_currentfanplanname,	lions_flag_currentgastm,	lions_flag_currentgastmname,	lions_flag_currentgroup,	lions_flag_currentgroupname,	lions_flag_currentlionsflashrecipient,	lions_flag_currentlionsflashrecipientname,	lions_flag_currentlogeboxstm,	lions_flag_currentlogeboxstmname,	lions_flag_currentonlinemerchbuyer,	lions_flag_currentonlinemerchbuyername,	lions_flag_currentpremiumclubstm,	lions_flag_currentpremiumclubstmname,	lions_flag_currentseasonticketmember,	lions_flag_currentseasonticketmembername,	lions_flag_currentsecondarymarketbuyer,	lions_flag_currentsecondarymarketbuyername,	lions_flag_currentsinglegamebuyer,	lions_flag_currentsinglegamebuyername,	lions_flag_currentsuiteleaseholder,	lions_flag_currentsuiteleaseholdername,	lions_flag_currentsuiterental,	lions_flag_currentsuiterentalname,	lions_flag_currenttunnelclubstm,	lions_flag_currenttunnelclubstmname,	lions_flag_currentyouthfootballparticipant,	lions_flag_currentyouthfootballparticipantname,	lions_flag_formercubclubmember,	lions_flag_formercubclubmembername,	lions_flag_formereventbuyer,	lions_flag_formereventbuyername,	lions_flag_formerfanplan,	lions_flag_formerfanplanname,	lions_flag_formergastm,	lions_flag_formergastmname,	lions_flag_formergroup,	lions_flag_formergroupname,	lions_flag_formerlionsflashrecipient,	lions_flag_formerlionsflashrecipientname,	lions_flag_formerlogeboxstm,	lions_flag_formerlogeboxstmname,	lions_flag_formeronlinemerchbuyer,	lions_flag_formeronlinemerchbuyername,	lions_flag_formerpremiumclubstm,	lions_flag_formerpremiumclubstmname,	lions_flag_formerseasonticketmember,	lions_flag_formerseasonticketmembername,	lions_flag_formersecondarymarketbuyer,	lions_flag_formersecondarymarketbuyername,	lions_flag_formersinglegamebuyer,	lions_flag_formersinglegamebuyername,	lions_flag_formersuiteleaseholder,	lions_flag_formersuiteleaseholdername,	lions_flag_formersuiterental,	lions_flag_formersuiterentalname,	lions_flag_formertunnelclubstm,	lions_flag_formertunnelclubstmname,	lions_flag_formeryouthfootballparticipant,	lions_flag_formeryouthfootballparticipantname,	lions_flag_lionsalumni,	lions_flag_lionsalumniname,	lions_flag_mobileappdownload,	lions_flag_mobileappdownloadname,	lions_flag_wifiuser,	lions_flag_wifiusername,	lions_ford_field_info,	lions_ford_field_infoname,	lions_id1,	lions_id2,	lions_id3,	lions_id4,	lions_noids,	lions_primaryaccountid,	str_clientfavoritedefense,	str_clientfavoriteoffense,	str_clientfavoriteopponent,	str_clientfavoriteopponentname,	str_clientfavoriteplayernfl,	str_clienttshirtsize,	str_clienttshirtsizename,	lions_classicrock,	lions_classicrockname,	lions_dem_hhincome,	lions_hiphoprb,	lions_hiphoprbname,	lions_sportingevents,	lions_sportingeventsname,	lions_alumni_activeseasons,	lions_alumni_betterserve,	lions_alumni_foundation,	lions_alumni_jerseynumber,	lions_alumni_othernflteams,	lions_alumni_position,	lions_collegemajor,	lions_communityinterests,	lions_flag_dlwa,	lions_flag_dlwaname,	lions_interestingfact,	lions_pref_classicalmusic,	lions_pref_classicalmusicname,	lions_pref_classicrock,	lions_pref_classicrockname,	lions_pref_countrymusic,	lions_pref_countrymusicname,	lions_pref_familyshows,	lions_pref_familyshowsname,	lions_pref_hiphoprb,	lions_pref_hiphoprbname,	lions_pref_popmusic,	lions_pref_popmusicname,	lions_pref_rapmusic,	lions_pref_rapmusicname,	lions_pref_rockmusic,	lions_pref_rockmusicname,	lions_pref_sportingevents,	lions_pref_sportingeventsname,	lions_pref_youthfootball,	lions_pref_youthfootballname,	lions_senioritydate,	lions_shirtsize,	lions_shirtsizename
FROM MERGEPROCESS_New.Queue a
JOIN mergeprocess_new.tmp_pccontact b
    ON a.Losing_ID = b.contactid
 
 
 
GO
